"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[922],{3905:(e,r,t)=>{t.d(r,{Zo:()=>u,kt:()=>d});var n=t(7294);function a(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function o(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function i(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?o(Object(t),!0).forEach((function(r){a(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function s(e,r){if(null==e)return{};var t,n,a=function(e,r){if(null==e)return{};var t,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)t=o[n],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)t=o[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var p=n.createContext({}),l=function(e){var r=n.useContext(p),t=r;return e&&(t="function"==typeof e?e(r):i(i({},r),e)),t},u=function(e){var r=l(e.components);return n.createElement(p.Provider,{value:r},e.children)},c={inlineCode:"code",wrapper:function(e){var r=e.children;return n.createElement(n.Fragment,{},r)}},f=n.forwardRef((function(e,r){var t=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),f=l(t),d=a,m=f["".concat(p,".").concat(d)]||f[d]||c[d]||o;return t?n.createElement(m,i(i({ref:r},u),{},{components:t})):n.createElement(m,i({ref:r},u))}));function d(e,r){var t=arguments,a=r&&r.mdxType;if("string"==typeof e||a){var o=t.length,i=new Array(o);i[0]=f;var s={};for(var p in r)hasOwnProperty.call(r,p)&&(s[p]=r[p]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var l=2;l<o;l++)i[l]=t[l];return n.createElement.apply(null,i)}return n.createElement.apply(null,t)}f.displayName="MDXCreateElement"},8365:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>p,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var n=t(7462),a=(t(7294),t(3905));const o={},i="Provisioning Infrastructure",s={unversionedId:"deploying-your-app/provisioning-infrastructure",id:"deploying-your-app/provisioning-infrastructure",title:"Provisioning Infrastructure",description:"The DJ Starter Project is designed to easily be deployed to AWS. We",source:"@site/docs/deploying-your-app/01-provisioning-infrastructure.md",sourceDirName:"deploying-your-app",slug:"/deploying-your-app/provisioning-infrastructure",permalink:"/dj-starter/docs/deploying-your-app/provisioning-infrastructure",draft:!1,editUrl:"https://github.com/shift3/dj-starter/tree/main/packages/create-docusaurus/templates/shared/docs/deploying-your-app/01-provisioning-infrastructure.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Setting Up Your Editor",permalink:"/dj-starter/docs/developing-your-app/setting-up-your-editor"},next:{title:"Deploying to AWS",permalink:"/dj-starter/docs/deploying-your-app/deploying-code"}},p={},l=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"Updating Staging or Prod Infrastructure",id:"updating-staging-or-prod-infrastructure",level:2}],u={toc:l};function c(e){let{components:r,...t}=e;return(0,a.kt)("wrapper",(0,n.Z)({},u,t,{components:r,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"provisioning-infrastructure"},"Provisioning Infrastructure"),(0,a.kt)("p",null,"The DJ Starter Project is designed to easily be deployed to AWS. We\nprovide files that easily allow you to spin up the AWS infrastructure\nnecessary to deploy the application."),(0,a.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,a.kt)("p",null,"The following tools must be installed to be able to provision AWS\ninfrastructure. Please note that if you used our\n",(0,a.kt)("a",{parentName:"p",href:"https://github.com/shift3/laptop"},"laptop")," script to setup your\ncomputer, you likely have these tools installed already."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://www.terraform.io/"},"Terraform")," for managing infrastructure and\nprovisioning it."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://aws.amazon.com/cli/"},"AWS Cli")," for storing your AWS\ncredentials for terraform to use.")),(0,a.kt)("h2",{id:"quick-start"},"Quick Start"),(0,a.kt)("p",null,"In order to start provisioning your infrastructure we need to initialize\nterraform. Before getting started, make sure you have AWS cli installed\nand the ",(0,a.kt)("inlineCode",{parentName:"p"},"shift3")," profile configured."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"aws configure --profile shift3\n")),(0,a.kt)("p",null,"Once we have the shift3 profile configured we need to initialize\nterraform. This is the first command that should be runl after writing a\nnew Terraform configuration or cloning an existing one from version\ncontrol. It is safe to run this command multiple times."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"terraform init\n")),(0,a.kt)("p",null,"Next we need to create a staging workspace. Workspaces allow you to\nmanage multiple sets of infrastructure. Commonly we use staging and\nprod. This project provides a staging setup out of the box, so lets set\nup our staging servers."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"terraform workspace new staging\n")),(0,a.kt)("p",null,"Now we can preview the infrastructure terraform will want to spin up by\nusing the ",(0,a.kt)("inlineCode",{parentName:"p"},"plan")," command."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"terraform plan -var-file=$(terraform workspace show).tfvars\n")),(0,a.kt)("p",null,"Finally, if the plan looks good, we can tell terraform to apply the plan\nand provision ",(0,a.kt)("strong",{parentName:"p"},"actual infrastructure")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"terraform apply -var-file=$(terraform workspace show).tfvars\n")),(0,a.kt)("h2",{id:"updating-staging-or-prod-infrastructure"},"Updating Staging or Prod Infrastructure"),(0,a.kt)("p",null,"First make sure you are on the correct workspace that you want to\nupdate."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"# Check current workspaces\nterraform workspace list\n\n# If we need to change workspaces\nterraform workspace select <desired-workspace>\n")),(0,a.kt)("p",null,"Simply make your modifications and run ",(0,a.kt)("inlineCode",{parentName:"p"},"plan")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"apply")," again."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"# Preview the changes to be made.\nterraform plan -var-file=$(terraform workspace show).tfvars\n\n# Look good? Apply the changes to your infrastructure\nterraform apply -var-file=$(terraform workspace show).tfvars\n")))}c.isMDXComponent=!0}}]);