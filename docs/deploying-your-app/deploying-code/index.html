<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-deploying-your-app/deploying-code">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<title data-rh="true">Deploying to AWS | DJ Starter Project</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://shift3.github.io/dj-starter/dj-starter/docs/deploying-your-app/deploying-code"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Deploying to AWS | DJ Starter Project"><meta data-rh="true" name="description" content="The Django Starter Project comes with a complete CircleCI configuration,"><meta data-rh="true" property="og:description" content="The Django Starter Project comes with a complete CircleCI configuration,"><link data-rh="true" rel="icon" href="/dj-starter/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://shift3.github.io/dj-starter/dj-starter/docs/deploying-your-app/deploying-code"><link data-rh="true" rel="alternate" href="https://shift3.github.io/dj-starter/dj-starter/docs/deploying-your-app/deploying-code" hreflang="en"><link data-rh="true" rel="alternate" href="https://shift3.github.io/dj-starter/dj-starter/docs/deploying-your-app/deploying-code" hreflang="x-default"><link rel="stylesheet" href="/dj-starter/assets/css/styles.85738e69.css">
<link rel="preload" href="/dj-starter/assets/js/runtime~main.201ee1ff.js" as="script">
<link rel="preload" href="/dj-starter/assets/js/main.9f7d9404.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/dj-starter/"><div class="navbar__logo"><img src="/dj-starter/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/dj-starter/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">DJ Starter Project</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/dj-starter/docs/getting-started/intro">Docs</a><a href="https://github.com/shift3/dj-starter" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/dj-starter/docs/getting-started/intro">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/dj-starter/docs/developing-your-app/installing-dependencies">Developing your App</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/dj-starter/docs/deploying-your-app/provisioning-infrastructure">Deploying your App</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dj-starter/docs/deploying-your-app/provisioning-infrastructure">Provisioning Infrastructure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/dj-starter/docs/deploying-your-app/deploying-code">Deploying to AWS</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/dj-starter/docs/features/api-pagination-sorting-filtering">Recipes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/dj-starter/docs/troubleshooting/docker">Troubleshooting</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/dj-starter/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Deploying your App</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Deploying to AWS</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Deploying to AWS</h1><p>The Django Starter Project comes with a complete CircleCI configuration,
as well as some useful scripts that make deployment a breeze. The
project is designed to be deployed automatically via CircleCI.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="setup-circleci">Setup CircleCI<a class="hash-link" href="#setup-circleci" title="Direct link to heading">​</a></h2><p>Applications are <strong>deployed automatically</strong> by CircleCI when commits are
pushed to <code>develop</code> or <code>main</code>. Make sure CircleCI is setup on your
project by visiting the <a href="https://circleci.com/vcs-authorize/" target="_blank" rel="noopener noreferrer">CircleCI
dashboard</a> for your project.</p><ul><li>Commits to the <code>develop</code>  branch are automatically deployed to the
<strong>Staging</strong> environment.</li><li>Commits to the <code>main</code>  branch are automatically deployed to the
<strong>Production</strong> environment.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="set-circleci-environment-variables">Set CircleCI Environment Variables<a class="hash-link" href="#set-circleci-environment-variables" title="Direct link to heading">​</a></h2><p>In order for automatic deploys to work, your CircleCI must be setup with
the correct environment variables. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-easy-way">The easy way<a class="hash-link" href="#the-easy-way" title="Direct link to heading">​</a></h3><p>We include a script that pulls the necessary environment variables from
your terraform state, and uploads them to CircleCI for you. In order to
run it, you will need to have already provisioned your terraform
infrastructure, <a href="https://app.circleci.com/projects/project-dashboard/github/Shift3/" target="_blank" rel="noopener noreferrer">setup the project on
CircleCI</a>,
and <a href="https://app.circleci.com/settings/user/tokens" target="_blank" rel="noopener noreferrer">created a CircleCI API
token</a>. Once your have
retrieved your CircleCI API token, simply run the following command,
replacing the values for <code>CIRCLECI_TOKEN</code> and <code>PROJECT_NAME</code> with your
own.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token assign-left variable" style="color:#36acaa">CIRCLECI_TOKEN</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">my-api-token </span><span class="token assign-left variable" style="color:#36acaa">PROJECT_NAME</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">my-project scripts/update-circleci.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Depending on your current <strong>terraform workspace</strong> the script will show
you what environment variables you will need, and will ask you if it&#x27;s
ok to set them on CircleCI. </p><p>After the script works, you can make a push to <code>develop</code> for staging, or
<code>main</code> for production, to start a deploy process and make sure
everything works.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-manual-way">The manual way<a class="hash-link" href="#the-manual-way" title="Direct link to heading">​</a></h3><p>The following environment variables are required to be set within the
CircleCI Project Settings. Descriptions (and example values) of the
environment variables follow:</p><ul><li><code>PROJECT_NAME</code><ul><li>The name of your project. This variable will be used to tag your docker image file. A safe name would be to use the same name as your git repository. Cannot contain spaces.</li><li><code>my-project</code></li></ul></li><li><code>STAGING_AWS_ACCESS_KEY_ID</code><ul><li>The AWS access key ID used to authenticate with AWS.</li><li><code>AKIAIOSFODNN7EXAMPLE</code></li></ul></li><li><code>STAGING_AWS_SECRET_ACCESS_KEY</code><ul><li>The AWS secret key used to authenticate with AWS.</li><li><code>wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY</code></li></ul></li><li><code>STAGING_AWS_DEFAULT_REGION</code><ul><li>The default region your infrastructure is deployed to.</li><li><code>us-west-2</code></li></ul></li><li><code>STAGING_AWS_ECR_ACCOUNT_URL</code><ul><li>The ECR (Elastic Container Repository) account url. This will be used to store the docker images that are built for production and staging.</li><li><code>012345678901.dkr.ecr.us-west-2.amazonaws.com</code></li></ul></li><li><code>STAGING_AWS_ECR_REPO_NAME</code><ul><li>The ECR repository name, this can be found in the AWS console.</li><li><code>my-project-ecr-repo</code></li></ul></li><li><code>STAGING_EB_ENVIRONMENT_NAME</code><ul><li>The EB (Elastic Beanstalk) environment name, this can be found in the AWS console.</li><li><code>my-project-api-webserver</code></li></ul></li><li><code>STAGING_EB_APPLICATION_NAME</code><ul><li>The EB application name, this can be found in the AWS console.</li><li><code>my-project</code></li></ul></li><li><code>STAGING_AWS_ROLE_ARN</code><ul><li>When using <a href="https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRole.html" target="_blank" rel="noopener noreferrer">AWS AssumeRole</a> (as bitwise does for AWS infastructure in our accounts). You must set this environment variable. When deploying to infrastructure outside of bitwise infrastructure, this variable is optional. The example value is the value you should use on bitwise infrastructure.</li><li><code>arn:aws:iam::008036621198:role/SuperDevAssumeRole</code></li></ul></li></ul><p>Once all of these are setup, commits to the <code>develop</code> branch should automatically deploy to your staging infrastructure. For more details on the deployment process, or if you need to customize it to fit your needs, check out the <code>.cirleci/config.yml</code> file.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploying-to-production">Deploying to Production<a class="hash-link" href="#deploying-to-production" title="Direct link to heading">​</a></h2><p>Production deploys from the <code>main</code> branch, and uses the same set of environment variables as staging just with <code>PRODUCTION</code> instead of <code>STAGING</code> in the names. The list of those variables follow:</p><ul><li><code>PRODUCTION_AWS_ACCESS_KEY_ID</code></li><li><code>PRODUCTION_AWS_SECRET_ACCESS_KEY</code></li><li><code>PRODUCTION_AWS_DEFAULT_REGION</code></li><li><code>PRODUCTION_AWS_ECR_ACCOUNT_URL</code></li><li><code>PRODUCTION_AWS_ECR_REPO_NAME</code></li><li><code>PRODUCTION_EB_ENVIRONMENT_NAME</code></li><li><code>PRODUCTION_EB_APPLICATION_NAME</code></li><li><code>PRODUCTION_AWS_ROLE_ARN</code> (optional)</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/shift3/dj-starter/tree/main/packages/create-docusaurus/templates/shared/docs/deploying-your-app/02-deploying-code.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/dj-starter/docs/deploying-your-app/provisioning-infrastructure"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Provisioning Infrastructure</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/dj-starter/docs/features/api-pagination-sorting-filtering"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Pagination, Sorting, and Filtering</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#setup-circleci" class="table-of-contents__link toc-highlight">Setup CircleCI</a></li><li><a href="#set-circleci-environment-variables" class="table-of-contents__link toc-highlight">Set CircleCI Environment Variables</a><ul><li><a href="#the-easy-way" class="table-of-contents__link toc-highlight">The easy way</a></li><li><a href="#the-manual-way" class="table-of-contents__link toc-highlight">The manual way</a></li></ul></li><li><a href="#deploying-to-production" class="table-of-contents__link toc-highlight">Deploying to Production</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/dj-starter/docs/getting-started/intro">Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Bitwise Industries</div></div></div></footer></div>
<script src="/dj-starter/assets/js/runtime~main.201ee1ff.js"></script>
<script src="/dj-starter/assets/js/main.9f7d9404.js"></script>
</body>
</html>